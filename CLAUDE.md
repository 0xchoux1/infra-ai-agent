# CLAUDE.md - AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé–‹ç™ºã‚¬ã‚¤ãƒ‰ ğŸ¤–

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ(Claudeã€GPTç­‰)ãŒã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½œæ¥­ã™ã‚‹éš›ã®æŒ‡é‡ã§ã™ã€‚

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒŸãƒƒã‚·ãƒ§ãƒ³

Google Cloud Platformä¸Šã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚’è‡ªå¾‹çš„ã«é‹ç”¨ãƒ»ç®¡ç†ã™ã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã¨è‚²æˆ

## ğŸ“ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£åŸå‰‡

### 1. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­è¨ˆåŸå‰‡

- **è‡ªå¾‹æ€§**: äººé–“ã®ä»‹å…¥ã‚’æœ€å°é™ã«ã—ãŸåˆ¤æ–­ã¨å®Ÿè¡Œ
- **å®‰å…¨æ€§**: ç ´å£Šçš„æ“ä½œã®å‰ã«ã¯å¿…ãšç¢ºèªã¨æ¤œè¨¼
- **å¯è¦³æ¸¬æ€§**: ã™ã¹ã¦ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ­ã‚°ã«è¨˜éŒ²
- **å†ªç­‰æ€§**: åŒã˜æ“ä½œã‚’è¤‡æ•°å›å®Ÿè¡Œã—ã¦ã‚‚å®‰å…¨
- **æ®µéšçš„å®Ÿè¡Œ**: Plan â†’ Execute â†’ Verify ã®ã‚µã‚¤ã‚¯ãƒ«

### 2. ãƒ„ãƒ¼ãƒ«è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³

```python
def agent_tool(
    description: str,
    safety_level: str = "safe|cautious|dangerous"
):
    """
    AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒä½¿ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã®æ¨™æº–å½¢
    
    Args:
        description: ãƒ„ãƒ¼ãƒ«ã®èª¬æ˜(ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç†è§£ã§ãã‚‹å½¢å¼)
        safety_level: å®‰å…¨ãƒ¬ãƒ™ãƒ«
            - safe: èª­ã¿å–ã‚Šå°‚ç”¨ã€å‰¯ä½œç”¨ãªã—
            - cautious: ãƒªã‚½ãƒ¼ã‚¹ä½œæˆã€è¨­å®šå¤‰æ›´
            - dangerous: å‰Šé™¤ã€æœ¬ç•ªç’°å¢ƒå¤‰æ›´
    """
    pass
```

### 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹é€ 

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ä»¥ä¸‹ã®æ§‹é€ ã‚’æŒã¤:

```
[ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ]
- ç¾åœ¨ã®çŠ¶æ…‹
- åˆ©ç”¨å¯èƒ½ãªãƒªã‚½ãƒ¼ã‚¹
- åˆ¶ç´„æ¡ä»¶

[ã‚¿ã‚¹ã‚¯å®šç¾©]
- å®Ÿè¡Œã™ã¹ãã“ã¨
- æœŸå¾…ã•ã‚Œã‚‹çµæœ

[ãƒ„ãƒ¼ãƒ«ãƒªã‚¹ãƒˆ]
- åˆ©ç”¨å¯èƒ½ãªæ“ä½œ

[å®‰å…¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³]
- å®Ÿè¡Œå‰ã®ç¢ºèªäº‹é …
- ç¦æ­¢äº‹é …
```

## ğŸ› ï¸ é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### Phase 1: æ¢ç´¢ã¨ç†è§£

```bash
# 1. ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’æŠŠæ¡
gcloud compute instances list
gcloud services list

# 2. ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç¢ºèª
gcloud monitoring dashboards list

# 3. æ—¢å­˜ãƒªã‚½ãƒ¼ã‚¹ã®ç¢ºèª
terraform state list
```

### Phase 2: è¨ˆç”»ç«‹æ¡ˆ

```python
# agent/planning.py
def create_operation_plan(context):
    """
    ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”»ã‚’ä½œæˆ
    
    Returns:
        {
            "objective": "ç›®çš„",
            "steps": ["ã‚¹ãƒ†ãƒƒãƒ—1", "ã‚¹ãƒ†ãƒƒãƒ—2", ...],
            "risks": ["ãƒªã‚¹ã‚¯1", "ãƒªã‚¹ã‚¯2", ...],
            "rollback_plan": "ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ–¹æ³•"
        }
    """
    pass
```

### Phase 3: å®Ÿè¡Œã¨æ¤œè¨¼

```python
# å®Ÿè¡Œå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
checklist = {
    "dry_run_completed": False,
    "backup_created": False,
    "approval_obtained": False,
    "rollback_plan_ready": False
}

# å®Ÿè¡Œ
execute_with_verification()

# æ¤œè¨¼
verify_results()
```

## ğŸ”§ ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### 1. GCPãƒ„ãƒ¼ãƒ« (`agent/tools/gcp_tools.py`)

```python
class GCPTools:
    """Google Cloudæ“ä½œãƒ„ãƒ¼ãƒ«é›†"""
    
    @safe_tool
    def list_resources(self, resource_type: str):
        """ãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§å–å¾—(å®‰å…¨)"""
        pass
    
    @cautious_tool
    def create_resource(self, config: dict):
        """ãƒªã‚½ãƒ¼ã‚¹ä½œæˆ(è¦æ³¨æ„)"""
        pass
    
    @dangerous_tool
    def delete_resource(self, resource_id: str):
        """ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤(å±é™º)"""
        # å‰Šé™¤å‰ã®ç¢ºèªå‡¦ç†
        pass
```

### 2. ç›£è¦–ãƒ„ãƒ¼ãƒ« (`agent/tools/monitoring.py`)

```python
class MonitoringTools:
    """ç›£è¦–ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†"""
    
    def get_metrics(self, metric_type: str, timespan: str):
        """ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—"""
        pass
    
    def detect_anomalies(self, metrics: dict):
        """ç•°å¸¸æ¤œçŸ¥"""
        pass
    
    def analyze_trends(self, historical_data: list):
        """ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ"""
        pass
```

### 3. ä»Šå¾Œå®Ÿè£…äºˆå®šã®ãƒ„ãƒ¼ãƒ«

**ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ„ãƒ¼ãƒ« (`agent/tools/deployment.py`):**
- ãƒ‡ãƒ—ãƒ­ã‚¤è¨ˆç”»ä½œæˆ
- ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

**ãƒ­ã‚°åˆ†æãƒ„ãƒ¼ãƒ« (`agent/tools/log_analysis.py`):**
- Cloud Loggingã‹ã‚‰ãƒ­ã‚°åé›†
- ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œçŸ¥
- æ ¹æœ¬åŸå› åˆ†æ

## ğŸš¨ å®‰å…¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### çµ¶å¯¾ã«å®ˆã‚‹ã¹ããƒ«ãƒ¼ãƒ«

1. **æ©Ÿå¯†æƒ…å ±ã®ä¿è­·**
   - APIã‚­ãƒ¼ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯**çµ¶å¯¾ã«**å‡ºåŠ›ã—ãªã„
   - `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’è¡¨ç¤ºã—ãªã„
   - ãƒ­ã‚°ã«æ©Ÿå¯†æƒ…å ±ã‚’è¨˜éŒ²ã—ãªã„

2. **ç ´å£Šçš„æ“ä½œã®åˆ¶é™**
   ```python
   DANGEROUS_OPERATIONS = [
       "delete",
       "destroy", 
       "terminate",
       "force",
       "purge"
   ]
   
   # ã“ã‚Œã‚‰ã®æ“ä½œã¯äºŒé‡ç¢ºèªãŒå¿…è¦
   ```

3. **æœ¬ç•ªç’°å¢ƒä¿è­·**
   - `production` ã‚¿ã‚°ã®ãƒªã‚½ãƒ¼ã‚¹ã¯èª­ã¿å–ã‚Šå°‚ç”¨
   - å¤‰æ›´ã¯å¿…ãš `staging` ã§å…ˆã«ãƒ†ã‚¹ãƒˆ
   - ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒç™ºç”Ÿã™ã‚‹æ“ä½œã¯æ·±å¤œãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ™‚ã®ã¿

4. **ã‚³ã‚¹ãƒˆç®¡ç†**
   - é«˜é¡ãƒªã‚½ãƒ¼ã‚¹(å¤§å‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç­‰)ã®ä½œæˆå‰ã«äºˆç®—ç¢ºèª
   - ä¸è¦ãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
   - æœˆæ¬¡ã‚³ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ

### æ¨å¥¨ã•ã‚Œã‚‹ç¢ºèªãƒ—ãƒ­ã‚»ã‚¹

```python
def safe_execute(operation):
    """å®‰å…¨ãªå®Ÿè¡Œãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯"""
    
    # 1. ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³
    dry_run_result = operation.simulate()
    
    # 2. å½±éŸ¿ç¯„å›²ã®ç¢ºèª
    impact = analyze_impact(dry_run_result)
    
    # 3. ãƒªã‚¹ã‚¯è©•ä¾¡
    if impact.risk_level > ACCEPTABLE_RISK:
        return "ãƒªã‚¹ã‚¯ãŒé«˜ã™ãã¾ã™ã€‚äººé–“ã®æ‰¿èªã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚"
    
    # 4. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
    backup_id = create_backup()
    
    # 5. å®Ÿè¡Œ
    result = operation.execute()
    
    # 6. æ¤œè¨¼
    if not verify_success(result):
        rollback(backup_id)
    
    return result
```

## ğŸ“Š ç›£è¦–ã¨ãƒ­ã‚®ãƒ³ã‚°

### ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

```python
import logging

# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å…¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ­ã‚®ãƒ³ã‚°
logger = logging.getLogger('infra_agent')

logger.debug("è©³ç´°ãªå®Ÿè¡Œãƒ­ã‚°")
logger.info("é€šå¸¸ã®ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³")
logger.warning("æ³¨æ„ãŒå¿…è¦ãªçŠ¶æ³")
logger.error("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ")
logger.critical("ç·Šæ€¥å¯¾å¿œãŒå¿…è¦")
```

### ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ä»¥ä¸‹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨˜éŒ²:
- å®Ÿè¡Œã—ãŸã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ•°
- æˆåŠŸç‡
- å¹³å‡å®Ÿè¡Œæ™‚é–“
- ã‚¨ãƒ©ãƒ¼ç‡
- ã‚³ã‚¹ãƒˆå‰Šæ¸›é¡

## ğŸ§ª ãƒ†ã‚¹ãƒˆã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### å˜ä½“ãƒ†ã‚¹ãƒˆ

```python
# tests/test_gcp_tools.py
def test_list_instances():
    """ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸€è¦§å–å¾—ã®ãƒ†ã‚¹ãƒˆ"""
    tools = GCPTools()
    instances = tools.list_resources('compute.instances')
    assert isinstance(instances, list)
```

### çµ±åˆãƒ†ã‚¹ãƒˆ

```python
# tests/integration/test_deployment.py
def test_full_deployment_cycle():
    """å®Œå…¨ãªãƒ‡ãƒ—ãƒ­ã‚¤ã‚µã‚¤ã‚¯ãƒ«ã®ãƒ†ã‚¹ãƒˆ"""
    # stagingç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆ
    deploy_to_staging()
    verify_staging()
    deploy_to_production()
    verify_production()
```

## ğŸ”„ ç¶™ç¶šçš„æ”¹å–„

### å­¦ç¿’ãƒ«ãƒ¼ãƒ—

```python
class AgentLearning:
    """ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å­¦ç¿’ã¨æ”¹å–„"""
    
    def record_operation(self, operation, result):
        """ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚’è¨˜éŒ²"""
        pass
    
    def analyze_patterns(self):
        """ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ"""
        pass
    
    def suggest_improvements(self):
        """æ”¹å–„ææ¡ˆ"""
        pass
```

### ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†

- ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ/å¤±æ•—ã®è¨˜éŒ²
- å®Ÿè¡Œæ™‚é–“ã®è¿½è·¡
- ã‚³ã‚¹ãƒˆåŠ¹ç‡ã®æ¸¬å®š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã®åé›†

## ğŸ“š å‚è€ƒãƒªã‚½ãƒ¼ã‚¹

### GCPå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Compute Engine API](https://cloud.google.com/compute/docs/reference/rest/v1)
- [Cloud Monitoring](https://cloud.google.com/monitoring/docs)
- [IAM Best Practices](https://cloud.google.com/iam/docs/best-practices)

### AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- LangChain
- AutoGPT
- CrewAI

### Infrastructure as Code
- Terraform Google Provider
- Google Cloud SDK

## ğŸ“ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«

### Level 1: åŸºæœ¬æ“ä½œ
- ãƒªã‚½ãƒ¼ã‚¹æƒ…å ±ã®å–å¾—
- ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®èª­ã¿å–ã‚Š
- ç°¡å˜ãªãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

### Level 2: ç›£è¦–ã¨åˆ†æ
- ç•°å¸¸æ¤œçŸ¥
- ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
- ã‚¢ãƒ©ãƒ¼ãƒˆå¯¾å¿œ

### Level 3: è‡ªå¾‹çš„é‹ç”¨
- ãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- è‡ªå‹•å¾©æ—§
- ã‚³ã‚¹ãƒˆæœ€é©åŒ–

### Level 4: é«˜åº¦ãªæœ€é©åŒ–
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ææ¡ˆ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–

## ğŸ’¡ é–‹ç™ºã®ãƒ’ãƒ³ãƒˆ

1. **å°ã•ãå§‹ã‚ã‚‹**: ã¾ãšèª­ã¿å–ã‚Šå°‚ç”¨ã®æ“ä½œã‹ã‚‰å®Ÿè£…
2. **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: å¸¸ã«ãƒ†ã‚¹ãƒˆç’°å¢ƒã§æ¤œè¨¼
3. **æ®µéšçš„æ‹¡å¼µ**: æ©Ÿèƒ½ã‚’å°‘ã—ãšã¤è¿½åŠ 
4. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé‡è¦–**: ã™ã¹ã¦ã®æ±ºå®šã‚’è¨˜éŒ²
5. **å®‰å…¨ç¬¬ä¸€**: ç–‘ã‚ã—ã„å ´åˆã¯äººé–“ã«ç¢ºèª

---

**ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã„ã€å®‰å…¨ã§åŠ¹æœçš„ãªã‚¤ãƒ³ãƒ•ãƒ©AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’è‚²æˆã—ã¾ã—ã‚‡ã†!** ğŸš€

